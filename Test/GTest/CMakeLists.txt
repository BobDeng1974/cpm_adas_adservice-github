# generated by DCIF CodeGen Version: R2_v2.3.0
# generated on: Tue Aug 01 13:37:53 CST 2017

#cmake -D CMAKE_SYSROOT=<SYSROOT_PATH> -D src-gen=<SRC-GEN_Build_Path> ..

set(OUTPUT_DIR ${CMAKE_SOURCE_DIR})
set(RE_BUILD_COMMAND make rebuild_cache)
set(COMPILE_COMMAND make compile)

cmake_minimum_required(VERSION 2.6)
add_definitions($ENV{CXXFLAGS} $ENV{LDFLAGS})

cmake_policy(SET CMP0015 NEW)
set_property(GLOBAL PROPERTY USE_FOLDERS ON)

set(ALIBROOTDIR "${PROJECT_SOURCE_DIR}")

include_directories(src-gen/provides)
#include_directories(./provides)
include_directories(${CMAKE_SYSROOT}/usr/include/CommonAPI-3.1)
#include_directories(./consumes)
include_directories(${CMAKE_SYSROOT}/usr/include)
include_directories(${CMAKE_SYSROOT}/usr/include/adas/libAGraphic/GuideLine)

link_directories(${CMAKE_SYSROOT}/usr/lib)
link_directories(${CMAKE_SYSROOT}/lib)

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -pthread -std=c++11 -fPIC")

OPTION(USE_INSTALLED_COMMONAPI "Set to OFF to use the local (build tree) version of CommonAPI" ON)
message(STATUS "USE_INSTALLED_COMMONAPI is set to value: ${USE_INSTALLED_COMMONAPI}")
if ("${USE_INSTALLED_COMMONAPI}" STREQUAL "ON")
endif()

message(STATUS "CommonAPI_CONSIDERED_CONFIGS: ${CommonAPI_CONSIDERED_CONFIGS}")
message(STATUS "COMMONAPI_INCLUDE_DIRS: ${COMMONAPI_INCLUDE_DIRS}")



#Checking ELINA_LITE_DCIF_GENERATOR path. If not defined,assigning with env path 
if("${ELINA_LITE_DCIF_GENERATOR}" STREQUAL "")                                      
   message(WARNING "ELINA_LITE_DCIF_GENERATOR is not defined. Hence considering $ENV{ELINA_LITE_DCIF_GENERATOR}.")
   set(ELINA_LITE_DCIF_GENERATOR $ENV{ELINA_LITE_DCIF_GENERATOR})
endif()

if(EXISTS ${CMAKE_SOURCE_DIR}/gen)
add_subdirectory(gen)
endif()

#if(EXISTS ${CMAKE_SOURCE_DIR}/src-gen)
#add_subdirectory(src-gen)
#endif()

#set(GEN_COMMAND ${ELINA_LITE_DCIF_GENERATOR} -application com.harman.dcif.codegen.cli.codeGenApplication -noSplash -src ${CDEPL_PATH} -dest ${OUTPUT_DIR})

#Generate command
add_custom_target(
generate ${GEN_COMMAND}
WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
DEPENDS cleanall
)
#Compilation
add_custom_target(
compile
WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
DEPENDS adastest
)

#Generate and compile
add_custom_target(
target
WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
DEPENDS generate
)

#Delete src-gen and gen dirs
add_custom_target(
cleanall ${CLEAN_GEN_COMMAND} 
COMMAND ${CLEAN_SRC_GEN_COMMAND}
WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
)

include_directories(
${COMMONAPI_INCLUDE_DIRS}
)

link_directories(
${COMMONAPI_LIBDIR}

)

LINK_DIRECTORIES(${src-gen})
add_definitions(-DLINUX_OS)

include_directories(${PROJECT_SOURCE_DIR}/../../src/provides/)
include_directories(${PROJECT_SOURCE_DIR}/../../include)
include_directories(${PROJECT_SOURCE_DIR}/../../include/Rvc)
include_directories(${PROJECT_SOURCE_DIR}/../../include/Camera)
include_directories(${PROJECT_SOURCE_DIR}/../../include/Client)
include_directories(${PROJECT_SOURCE_DIR}/../../include/Avm)
include_directories(${PROJECT_SOURCE_DIR}/../../include/Pas)

include_directories(${CMAKE_SYSROOT}/usr/include/adas/libAFoundation)
include_directories(${CMAKE_SYSROOT}/usr/include/adas/libABase)
include_directories(${CMAKE_SYSROOT}/usr/include/adas/libAGraphic)
include_directories(${CMAKE_SYSROOT}/usr/include/adas/CaseClient)

link_directories(${CMAKE_SYSROOT}/usr/lib/adas)

#SET(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin/linux)

MESSAGE(STATUS "ADAS are looking for lib in dir " ${CMAKE_SYSROOT})
MESSAGE(STATUS "This is binary ADAS dir " ${PROJECT_SOURCE_DIR})

AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/../../src MAIN_SRC)
AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/../../src/Camera CAM_SRC)
AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/../../src/Rvc RVC_SRC)
AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/../../src/Client CLIENT_SRC)
AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/../../src/Avm AVM_SRC)
AUX_SOURCE_DIRECTORY(${PROJECT_SOURCE_DIR}/../../src/Pas PAS_SRC)

add_executable(
adastest
${MAIN_SRC} ${CAM_SRC} ${RVC_SRC} ${CLIENT_SRC}  ${AVM_SRC} ${PAS_SRC}
src-gen/provides
gen/dbus/provides
src-gen/provides
gen/dbus/provides
${PROJECT_SOURCE_DIR}/../../src/provides/v0/com/harman/adas/AdasServiceStubImpl.cpp
${PROJECT_SOURCE_DIR}/../../src/provides/v0/com/harman/adas/PASServiceStubImpl.cpp
${PROJECT_SOURCE_DIR}/../../src/provides/v0/com/harman/adas/RvcServiceStubImpl.cpp
${PROJECT_SOURCE_DIR}/../../src/provides/v0/com/harman/adas/AVMServiceStubImpl.cpp
${PROJECT_SOURCE_DIR}/../../src/provides/v0/com/harman/adas/APAServiceStubImpl.cpp
)

target_link_libraries(
adastest
adas_adas_types_static_stub
AFoundation ABase ACaseSocket AGraphic dlt
wayland-client wayland-egl wayland-cursor GLESv2 EGL ivi-application nanomsg ilmCommon ilmClient ilmControl nanomsg
-Wl,--no-undefined,--as-needed CommonAPI
rt)
